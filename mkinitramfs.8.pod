# See COPYING and COPYRIGHT files for corresponding information.

=pod

=head1 NAME

mkinitramfs - create an initial ramdisk environment

=head1 SYNOPSIS

B<mkinitramfs> [I<OPTION>]...

=head1 DESCRIPTION

B<mkinitramfs> creates an initial ramdisk environment for booting the
Linux kernel.  The initial ramdisk is in essence a very small
environment (early userspace) which loads various kernel modules and
sets up necessary things before handing over control to init.  This
makes it possible to have, for example, encrypted root file systems
and root file systems on a software RAID array.  B<mkinitramfs> can be
extended with custom hooks.

=head1 OPTIONS

Mandatory arguments to long options are mandatory for short options
too.

=over 8

=item B<-D>, B<--helper>=I<FILE>

Specify an alternate device helper file.

Default: F</usr/share/mkinitramfs/device-helper>.

=item B<-H>, B<--hooks>=I<DIR>

Specify additional directory for hooks.  By default, B<mkinitramfs>
uses F</usr/share/mkinitramfs/hooks> and F</etc/mkinitramfs/hooks>.

=item B<-I>, B<--init>=I<FILE>

Specify an alternate init script.

Default: F</usr/share/mkinitramfs/init>.

=item B<-c>, B<--config>=I<FILE>

Specify an alternate configuration file.

Default: F</etc/mkinitramfs/config>.

=item B<-f>, B<--force>

Forcefully overwrite initramfs image.

=item B<-k>, B<--kernel>=I<VERSION>

Specify kernel version.  Useful for bootstrapping future system with
modular kernel.

Default: Current running kernel (C<uname -r>).

=item B<-m>, B<--modules>=I<DIR>

Specify an alternate directory where where kernel modules stored.

This option has no effect if B<monolith> or B<hostonly> were enabled
in configuration file.

Default: F</lib/modules>.

=item B<-o>, B<--output>=I<FILE>

Specify an alternate output file where initramfs image will be stored.

Default: F</tmp/mkinitramfs-C<kernel_version>>

=item B<-v>, B<--version>

Print version and exit.

=item B<-h>, B<--help>

Print help and exit.

=back

=head1 ENVIRONMENT

B<mkinitramfs> uses the C<TMPDIR> environment variable.  If set, it
uses subdirectories in the given directory to create its temporary
working directories.  Else it uses C</tmp> as default value for that
purpose.  The given directory should be on a filesystem which allows
the execution of files stored there, i.e. should not be mounted with
the B<noexec> mount option.

=head1 FILES

=over

=item F</etc/mkinitramfs/config>

The default configuration file for the script.  See
L<mkinitramfs.config(5)> for a description of the available
configuration parameters.

=item F</usr/share/mkinitramfs/hooks/>

=item F</etc/mkinitramfs/hooks/>

Hooks directories for B<mkinitramfs>.

=item F</usr/share/mkinitramfs/init>

Init for B<mkinitramfs>.

=item F</usr/share/mkinitramfs/device-helper>

Device-helper for B<mkinitramfs>.

=back

=head1 EXAMPLES

=over

=item Create an initramfs for current running kernel:

  mkinitramfs -o /tmp/initramfs-`uname -r`.img

=item Create an initramfs for specific kernel:

  mkinitramfs -o /tmp/initramfs-5.4.224.img -k 5.4.224

=item Debug initramfs creation (check out written logfile):

  sh -x `which mkinitramfs` -o /tmp/initramfs-`uname -r` 2>/tmp/log

=back

=head1 NOTES

If you have modular kernel and you use B<busybox' modprobe> to handle
modules, you must note that B<busybox' modprobe> doesn't have ability
to install soft dependencies of modules (i.e. F<modules.softdep>).
You must install them yourself using hooks.  See
L<mkinitramfs.hooks(7)> how to do it.

=head1 SEE ALSO

L<mkinitramfs.config(5)>, L<mkinitramfs.cmdline(7)>,
L<mkinitramfs.hooks(7)>

=over

=item Kernel subsystem documentation:

L<Filesystems in the Linux kernel: Ramfs, rootfs and initramfs|https://docs.kernel.org/filesystems/ramfs-rootfs-initramfs.html>.

=item Linux kernel user's and administrator's guide:

L<Using the initial RAM disk (initrd)|https://docs.kernel.org/admin-guide/initrd.html>.

=back

=cut

# vim: cc=72 tw=70
# End of file.
